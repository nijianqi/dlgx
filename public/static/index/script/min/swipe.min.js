!function(t){function i(i,e){this.box=t(i),this.config=t.extend({},e||{}),this.width=this.config.width||this.box.children().eq(0).width(),this.size=this.config.size||this.box.children().length,this.loop=this.config.loop||!0,this.auto=this.config.auto||!0,this.auto_wait_time=this.config.auto_wait_time||3e3,this.scroll_time=300,this.minleft=-this.width*(this.size-1),this.maxleft=0,this.now_left=0,this.point_x=null,this.point_y=null,this.move_left=!1,this.index=0,this.busy=!1,this.timer,this.init()}t.extend(i.prototype,{init:function(){this.bind_event(),this.init_loop(),this.auto_scroll()},bind_event:function(){var t=this;t.box.bind("touchstart",function(i){1!=i.touches.length||t.busy||(t.point_x=i.touches[0].screenX,t.point_y=i.touches[0].screenY)}).bind("touchmove",function(i){if(1==i.touches.length&&!t.busy)return t.move(i.touches[0].screenX,i.touches[0].screenY)}).bind("touchend",function(i){!t.busy&&t.move_end()})},init_loop:function(){this.box.children().length==this.size&&this.loop?(this.now_left=-this.width,this.minleft=-this.width*this.size,this.maxleft=-this.width,this.box.prepend(this.box.children().eq(this.size-1).clone()).append(this.box.children().eq(1).clone()).css(this.get_style(2)),this.box.css("width",this.width*(this.size+2))):(this.loop=!1,this.box.css("width",this.width*this.size))},auto_scroll:function(){var t=this;t.loop&&t.auto&&(clearTimeout(t.timer),t.timer=setTimeout(function(){t.go_index(t.index+1)},t.auto_wait_time))},go_index:function(t){var i=this;i.busy||(clearTimeout(i.timer),i.busy=!0,i.loop?(t=t<0?-1:t,t=t>i.size?i.size:t):(t=t<0?0:t,t=t>=i.size?i.size-1:t),i.loop||i.now_left!=-(i.width*t)?i.loop&&i.now_left==-i.width*(t+1)?i.complete(t):(t==-1||t==i.size?(i.index=t==-1?i.size-1:0,i.now_left=t==-1?0:-i.width*(i.size+1)):(i.index=t,i.now_left=-(i.width*(i.index+(i.loop?1:0)))),i.box.css(this.get_style(1)),setTimeout(function(){i.complete(t)},i.scroll_time)):i.complete(t))},complete:function(t){var i=this;i.busy=!1,i.config.callback&&i.config.callback(i.index),t==-1?i.now_left=i.minleft:t==i.size&&(i.now_left=i.maxleft),i.box.css(this.get_style(2)),i.auto_scroll()},next:function(){this.busy||this.go_index(this.index+1)},prev:function(){this.busy||this.go_index(this.index-1)},move:function(t,i){var e=t-(null===this.point_x?t:this.point_x),s=i-(null===this.point_y?i:this.point_y),n=this.now_left,o=!1,h=s/Math.sqrt(e*e+s*s);return this.now_left=n+e,this.move_left=e<0,(h>Math.sin(Math.PI/3)||h<-Math.sin(Math.PI/3))&&(o=!0),this.point_x=t,this.point_y=i,this.box.css(this.get_style(2)),o},move_end:function(){var t,i=this.now_left%this.width;t=this.now_left<this.minleft?this.index+1:this.now_left>this.maxleft?this.index-1:0!=i?this.move_left?this.index+1:this.index-1:this.index,this.point_x=this.point_y=null,this.go_index(t)},get_style:function(t){var i=this.now_left,e=1==t?this.scroll_time:0;return{"-webkit-transition":"-webkit-transform "+e+"ms","-webkit-transform":"translate3d("+i+"px,0,0)","-webkit-backface-visibility":"hidden",transition:"transform "+e+"ms",transform:"translate3d("+i+"px,0,0)"}}}),t.mggScrollImg=function(t,e){var s=new i(t,e);return{next:function(){s.next()},prev:function(){s.prev()},go:function(t){s.go_index(parseInt(t)||0)}}}}(Zepto);